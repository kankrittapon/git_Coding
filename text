BASE_PATH = Path(getattr(sys, '_MEIPASS', Path(__file__).resolve().parent))

USER_CONFIG_PATH = Path(__file__).resolve().parent / "user_config.json"  # ให้แก้ไขได้
LINE_USER_CONFIG_PATH = Path(__file__).resolve().parent / "booking_elements/config_line_user.json"  # ให้แก้ไขได้

# ส่วนที่ไม่ควรแก้ (อยู่ใน .exe)
BRANCH_CONFIG_PATH = BASE_PATH / "branch/config.json"
TIME_CONFIG_PATH = BASE_PATH / "branch/time.json"

pip install pyarmor
pyarmor gen main.py gui_app.py live_mode.py trial_mode.py utils.py booking_scripts/*.py

pyinstaller main.py --onefile --noconsole `
  --add-data "gui_app.py;." `
  --add-data "live_mode.py;." `
  --add-data "trial_mode.py;." `
  --add-data "utils.py;." `
  --add-data "booking_scripts;booking_scripts" `
  --add-data "booking_elements\ithitec.json;booking_elements" `
  --add-data "booking_elements\pmrocket.json;booking_elements" `
  --add-data "booking_elements\rocketbooking.json;booking_elements" `
  --add-data "booking_elements\schedule_config.json;booking_elements" `
  --add-data "branch\config.json;branch" `
  --add-data "branch\time.json;branch"


import traceback

if __name__ == "__main__":
    try:
        # โค้ดเดิมที่คุณเรียกเริ่มโปรแกรม
        from gui_app import start_gui
        start_gui()  # หรืออะไรก็ตามที่ใช้เป็นจุดเริ่ม
    except Exception:
        with open("error_log.txt", "w", encoding="utf-8") as f:
            f.write(traceback.format_exc())

from gui_app import run_gui_app  # ✅ ถูกต้อง
run_gui_app(all_configs, gsheet_users_data)

if mode_arg == "--gui":
    print("Starting GUI mode...")
    from gui_app import run_gui_app
    run_gui_app(all_configs, gsheet_users_data)
