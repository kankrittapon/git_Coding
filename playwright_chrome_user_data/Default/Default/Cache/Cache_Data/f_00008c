1/0/_dk_https://google.com https://google.com https://www.google.com/search?q=import+json+import+time+import+threading+%23+%E0%B9%80%E0%B8%9E%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%99%E0%B8%B3%E0%B9%80%E0%B8%82%E0%B9%89%E0%B8%B2+threading+import+datetime+import+calendar+import+subprocess+from+tkinter+import+Tk%2C+Label%2C+Button%2C+Text%2C+END%2C+Toplevel%2C+ttk%2C+messagebox%2C+StringVar%2C+BooleanVar+from+queue+import+Queue+from+playwright.sync_api+import+sync_playwright%2C+Page%2C+BrowserContext%2C+BrowserType+from+playwright.sync_api+import+Error+as+PlaywrightError+from+site_handlers+import+test_sites+from+site_handlers+import+production_sites+%23+---+Global+Variables+for+GUI+and+Automation+---+APP_CONFIG+%3D+%7B%7D+USER_APP_CONFIG+%3D+%7B%7D+log_queue+%3D+Queue()+stop_event+%3D+threading.Event()+%23+---+Configuration+Loading+---+CONFIG_FILE_NAME+%3D+%27config.json%27+USER_CONFIG_FILE_NAME+%3D+%27user_config.json%27+def+load_config()%3A+%22%22%22Loads+configuration+from+config.json+and+user_config.json.%22%22%22+global+APP_CONFIG%2C+USER_APP_CONFIG+try%3A+with+open(CONFIG_FILE_NAME%2C+%27r%27%2C+encoding%3D%27utf-8%27)+as+f%3A+APP_CONFIG+%3D+json.load(f)+log_message(f%22%E2%9C%85+%E0%B9%82%E0%B8%AB%E0%B8%A5%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%88%E0%B8%B2%E0%B8%81+%27%7BCONFIG_FILE_NAME%7D%27+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+with+open(USER_CONFIG_FILE_NAME%2C+%27r%27%2C+encoding%3D%27utf-8%27)+as+f%3A+USER_APP_CONFIG+%3D+json.load(f)+log_message(f%22%E2%9C%85+%E0%B9%82%E0%B8%AB%E0%B8%A5%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%88%E0%B8%B2%E0%B8%81+%27%7BUSER_CONFIG_FILE_NAME%7D%27+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+except+FileNotFoundError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json%3A+%7Be%7D%22)+log_message(%22+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A%E0%B8%A7%E0%B9%88%E0%B8%B2%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C%E0%B8%97%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%AD%E0%B8%A2%E0%B8%B9%E0%B9%88%E0%B9%83%E0%B8%99%E0%B9%82%E0%B8%9F%E0%B8%A5%E0%B9%80%E0%B8%94%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%94%E0%B8%B5%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%81%E0%B8%B1%E0%B8%9A+main.py+%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%A1%E0%B8%B5%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json%22)+exit()+except+json.JSONDecodeError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B8%A3%E0%B8%B9%E0%B8%9B%E0%B9%81%E0%B8%9A%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87+(JSON+Error)%3A+%7Be%7D%22)+log_message(%22+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A+syntax+%E0%B9%83%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+JSON+%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B8%B8%E0%B8%93%22)+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B8%A3%E0%B8%B9%E0%B8%9B%E0%B9%81%E0%B8%9A%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+exit()+except+ValueError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%83%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%3A+%7Be%7D%22)+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%83%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+exit()+%23+---+Logging+Function+for+GUI+---+def+log_message(message)%3A+%22%22%22Puts+a+message+into+the+log+queue+to+be+displayed+in+the+GUI.%22%22%22+log_queue.put(message)+%23+---+Playwright+Connection+Function+---+def+connect_to_existing_browser(playwright_instance%3A+sync_playwright%2C+debugging_port%3A+int%2C+target_url%3A+str%2C+auto_navigate%3A+bool+%3D+False)+-%3E+Page%3A+%22%22%22+Connects+to+an+existing+browser+via+Debugging+Port.+Navigates+automatically+if+auto_navigate+is+True.+%22%22%22+log_message(f%22%5Cn---+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%9E%E0%B8%A2%E0%B8%B2%E0%B8%A2%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%9C%E0%B9%88%E0%B8%B2%E0%B8%99+Debugging+Port+%7Bdebugging_port%7D+---%22)+page+%3D+None+try%3A+browser+%3D+playwright_instance.chromium.connect_over_cdp(f%22http%3A%2F%2F127.0.0.1%3A%7Bdebugging_port%7D%22)+pages+%3D+browser.contexts%5B0%5D.pages+if+not+pages%3A+raise+Exception(%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A+Page+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B8%AD%E0%B8%A2%E0%B8%B9%E0%B9%88%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%22)+page+%3D+pages%5B0%5D+page.evaluate(%22Object.defineProperty(navigator%2C+%27webdriver%27%2C+%7Bget%3A+()+%3D%3E+undefined%7D)%22)+log_message(f%22%E2%9C%85+%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88+Port+%7Bdebugging_port%7D+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+current_url+%3D+page.url+log_message(f%22+URL+%E0%B8%9B%E0%B8%B1%E0%B8%88%E0%B8%88%E0%B8%B8%E0%B8%9A%E0%B8%B1%E0%B8%99%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%3A+%7Bcurrent_url%7D%22)+if+auto_navigate%3A+if+target_url+not+in+current_url%3A+log_message(f%22+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%84%E0%B8%9B%E0%B8%97%E0%B8%B5%E0%B9%88%3A+%7Btarget_url%7D+%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4...%22)+page.goto(target_url%2C+wait_until%3D%27domcontentloaded%27)+log_message(f%22+%E2%9C%85+%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%84%E0%B8%9B%E0%B8%A2%E0%B8%B1%E0%B8%87+%7Btarget_url%7D+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7.%22)+else%3A+log_message(%22+%E2%9C%85+URL+%E0%B8%95%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AD%E0%B8%A2%E0%B8%B9%E0%B9%88%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+(%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%8B%E0%B9%89%E0%B8%B3).%22)+else%3A+if+target_url+not+in+current_url%3A+log_message(f%22+%E2%9A%A0%EF%B8%8F+URL+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%95%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81+(%7Btarget_url%7D)%22)+log_message(f%22+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%84%E0%B8%9B%E0%B8%97%E0%B8%B5%E0%B9%88%3A+%7Btarget_url%7D+%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%95%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%87+%E0%B8%96%E0%B9%89%E0%B8%B2%E0%B8%A2%E0%B8%B1%E0%B8%87%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+start_time+%3D+time.time()+while+target_url+not+in+page.url+and+time.time()+-+start_time+%3C+300%3A+time.sleep(2)+log_message(f%22+%5B%E0%B8%A3%E0%B8%AD%5D+URL+%E0%B8%A2%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%3A+%7Bpage.url%7D%22)+if+stop_event.is_set()%3A+%23+Check+for+stop+signal+raise+Exception(%22%E0%B8%AB%E0%B8%A2%E0%B8%B8%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%84%E0%B8%B3%E0%B8%AA%E0%B8%B1%E0%B9%88%E0%B8%87%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%22)+if+target_url+not+in+page.url%3A+log_message(%22%E2%9D%8C+%E0%B8%AB%E0%B8%A1%E0%B8%94%E0%B9%80%E0%B8%A7%E0%B8%A5%E0%B8%B2%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+URL+%E0%B8%A2%E0%B8%B1%E0%B8%87%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B8%A3%E0%B8%A1%E0%B8%88%E0%B8%B0%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B9%88%E0%B8%AD%22)+raise+Exception(%22URL+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%84%E0%B8%9B%E0%B8%A2%E0%B8%B1%E0%B8%87+URL+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%22)+else%3A+log_message(%22+%E2%9C%85+URL+%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7!+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B9%88%E0%B8%AD%22)+return+page+except+PlaywrightError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR+(Playwright)%3A+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%84%E0%B8%94%E0%B9%89%3A+%7Be%7D%22)+log_message(%22+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A%3A%22)+log_message(f%22+1.+%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94+Google+Chrome%2FEdge+%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2+--remote-debugging-port%3D%7Bdebugging_port%7D+%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A2%E0%B8%B1%E0%B8%87%3F%22)+log_message(%22+%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B8%AD%E0%B8%A2%E0%B9%88%E0%B8%B2%E0%B8%87%3A+%5C%22C%3A%5C%5CProgram+Files%5C%5CGoogle%5C%5CChrome%5C%5CApplication%5C%5Cchrome.exe%5C%22+--remote-debugging-port%3D9222%22)+log_message(%22+2.+%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%A3%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%9E%E0%B8%B5%E0%B8%A2%E0%B8%87+Instance+%E0%B9%80%E0%B8%94%E0%B8%B5%E0%B8%A2%E0%B8%A7%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%83%E0%B8%8A%E0%B9%89+Port+%E0%B8%99%E0%B8%B5%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%88%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%84%E0%B8%A1%E0%B9%88%3F%22)+log_message(%22+3.+%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%AD%E0%B8%B2%E0%B8%88%E0%B8%9A%E0%B8%A5%E0%B9%87%E0%B8%AD%E0%B8%81%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%9C%E0%B9%88%E0%B8%B2%E0%B8%99+Debugging+Protocol%22)+raise+except+Exception+as+e%3A+log_message(f%22%E2%9D%8C+ERROR+(%E0%B8%97%E0%B8%B1%E0%B9%88%E0%B8%A7%E0%B9%84%E0%B8%9B)%3A+%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%9E%E0%B8%A5%E0%B8%B2%E0%B8%94%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%84%E0%B8%B2%E0%B8%94%E0%B8%84%E0%B8%B4%E0%B8%94%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%3A+%7Be%7D%22)+raise+%23+---+Worker+Thread+Function+---+def+run_task_in_thread(site_config_data%2C+handler_function%2C+debugging_port%3A+int%2C+browser_name%3A+str%2C+auto_navigate%3A+bool%2C+auto_register_enabled%3A+bool)%3A+%22%22%22+Function+to+run+the+automation+task+in+a+separate+thread.+Handles+Playwright+setup+and+teardown+within+the+thread.+%22%22%22+session_name+%3D+site_config_data.get(%22session_name%22%2C+%22Unnamed+Session%22)+target_url+%3D+site_config_data%5B%22url%22%5D+log_message(f%22%5Cn---+%5BThread%5D+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%95%E0%B9%89%E0%B8%99+Thread+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+---%22)+page+%3D+None+context+%3D+None+try%3A+with+sync_playwright()+as+p%3A+context+%3D+connect_to_existing_browser(p%2C+debugging_port%2C+target_url%2C+auto_navigate)+page+%3D+context.new_page()+page.evaluate(%22Object.defineProperty(navigator%2C+%27webdriver%27%2C+%7Bget%3A+()+%3D%3E+undefined%7D)%22)+%23+Pass+auto_register_enabled+to+the+handler+function+success+%3D+handler_function(page%2C+site_config_data%2C+auto_register_enabled%2C+stop_event)+if+success%3A+log_message(f%22%E2%9C%85+%5BThread%5D+Task+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%A3%E0%B9%87%E0%B8%88!%22)+else%3A+log_message(f%22%E2%9D%8C+%5BThread%5D+Task+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%A3%E0%B9%87%E0%B8%88!%22)+except+Exception+as+e%3A+log_message(f%22%E2%9D%8C+%5BThread%5D+%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%9E%E0%B8%A5%E0%B8%B2%E0%B8%94%E0%B9%83%E0%B8%99+Thread+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27.+%E0%B8%A3%E0%B8%B2%E0%B8%A2%E0%B8%A5%E0%B8%B0%E0%B9%80%E0%B8%AD%E0%B8%B5%E0%B8%A2%E0%B8%94%3A+%7Be%7D%22)+finally%3A+if+context%3A+context.close()+log_message(f%22---+%5BThread%5D+%E0%B8%9B%E0%B8%B4%E0%B8%94+Page+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+---%22)+log_message(f%22---+%5BThread%5D+Task+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B8%88%E0%B8%9A%E0%B8%A5%E0%B8%87%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+---%22)+%23+Signal+main+thread+if+all+tasks+are+done+(optional%2C+for+GUI+state)+%23+---+GUI+Application+Class+---+class+AutoBookingApp%3A+def+__init__(self%2C+master)%3A+self.master+%3D+master+master.title(%22Pop+Mart+Auto+Booking+(GUI)%22)+master.geometry(%22800x700%22)+%23+%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B8%82%E0%B8%99%E0%B8%B2%E0%B8%94%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%95%E0%B9%89%E0%B8%99%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%E0%B8%95%E0%B9%88%E0%B8%B2%E0%B8%87+self.running_threads+%3D+%5B%5D+%23+Keep+track+of+active+threads+self.stop_event+%3D+threading.Event()+%23+For+stopping+threads+self.app_config+%3D+APP_CONFIG+self.user_app_config+%3D+USER_APP_CONFIG+self.windows_username+%3D+self.user_app_config.get(%22windows_username%22%2C+%22YourUsernameHere%22)+self.create_widgets()+self.update_log()+%23+Start+updating+log+messages+def+create_widgets(self)%3A+%23+---+Frame+for+Controls+---+control_frame+%3D+ttk.LabelFrame(self.master%2C+text%3D%22%E0%B8%84%E0%B8%A7%E0%B8%9A%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%22%2C+padding%3D%2210%22)+control_frame.pack(padx%3D10%2C+pady%3D10%2C+fill%3D%22x%22)+%23+Mode+Selection+ttk.Label(control_frame%2C+text%3D%22%E0%B9%82%E0%B8%AB%E0%B8%A1%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%3A%22).grid(row%3D0%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.mode_var+%3D+StringVar(value%3D%22test%22)+self.mode_test_radio+%3D+ttk.Radiobutton(control_frame%2C+text%3D%22Test%22%2C+variable%3Dself.mode_var%2C+value%3D%22test%22%2C+command%3Dself.update_site_options)+self.mode_test_radio.grid(row%3D0%2C+column%3D1%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.mode_prod_radio+%3D+ttk.Radiobutton(control_frame%2C+text%3D%22Production%22%2C+variable%3Dself.mode_var%2C+value%3D%22production%22%2C+command%3Dself.update_site_options)+self.mode_prod_radio.grid(row%3D0%2C+column%3D2%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+%23+Site+Selection+ttk.Label(control_frame%2C+text%3D%22%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81+Site%3A%22).grid(row%3D1%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.site_options+%3D+%5B%5D+self.site_var+%3D+StringVar()+self.site_dropdown+%3D+ttk.Combobox(control_frame%2C+textvariable%3Dself.site_var%2C+state%3D%22readonly%22)+self.site_dropdown.grid(row%3D1%2C+column%3D1%2C+columnspan%3D2%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+self.site_dropdown.bind(%22%3C%3CComboboxSelected%3E%3E%22%2C+self.on_site_selected)+self.update_site_options()+%23+Populate+initial+site+options+%23+Browser+Selection+ttk.Label(control_frame%2C+text%3D%22%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%3A%22).grid(row%3D2%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.browser_options+%3D+%7B+%22Google+Chrome%22%3A+%22start_chrome_debug.bat%22%2C+%22Microsoft+Edge%22%3A+%22start_edge_debug.bat%22%2C+%23+%22Mozilla+Firefox%22%3A+r%22C%3A%5CProgram+Files%5CMozilla+Firefox%5Cfirefox.exe%22+%23+Firefox+not+supported+by+connect_over_cdp+%7D+self.browser_var+%3D+StringVar(value%3Dlist(self.browser_options.keys())%5B0%5D)+self.browser_dropdown+%3D+ttk.Combobox(control_frame%2C+textvariable%3Dself.browser_var%2C+values%3Dlist(self.browser_options.keys())%2C+state%3D%22readonly%22)+self.browser_dropdown.grid(row%3D2%2C+column%3D1%2C+columnspan%3D2%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+%23+Debugging+Port+ttk.Label(control_frame%2C+text%3D%22Debugging+Port%3A%22).grid(row%3D3%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.port_entry+%3D+ttk.Entry(control_frame)+self.port_entry.insert(0%2C+%229222%22)+self.port_entry.grid(row%3D3%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+%23+Use+Profile+Checkbox+self.use_profile_var+%3D+BooleanVar(value%3DTrue)+self.use_profile_checkbox+%3D+ttk.Checkbutton(control_frame%2C+text%3D%22%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%80%E0%B8%94%E0%B8%B4%E0%B8%A1%22%2C+variable%3Dself.use_profile_var%2C+command%3Dself.toggle_profile_path_entry)+self.use_profile_checkbox.grid(row%3D4%2C+column%3D0%2C+columnspan%3D2%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+%23+Profile+Path+Entry+(hidden+by+default)+self.profile_path_label+%3D+ttk.Label(control_frame%2C+text%3D%22User+Profile+Path%3A%22)+self.profile_path_label.grid(row%3D5%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.profile_path_entry+%3D+ttk.Entry(control_frame)+self.profile_path_entry.grid(row%3D5%2C+column%3D1%2C+columnspan%3D2%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+self.profile_path_entry.insert(0%2C+f%22C%3A%5C%5CUsers%5C%5C%7Bself.windows_username%7D%5C%5CAppData%5C%5CLocal%5C%5CGoogle%5C%5CChrome%5C%5CUser+Data%5C%5CDefault%22)+self.toggle_profile_path_entry()+%23+Set+initial+state+%23+Auto-Register%2FRetry+Branch+Checkbox+self.auto_register_var+%3D+BooleanVar(value%3DTrue)+self.auto_register_checkbox+%3D+ttk.Checkbutton(control_frame%2C+text%3D%22%E0%B8%84%E0%B8%A5%E0%B8%B4%E0%B8%81+Register%2F%E0%B8%A5%E0%B8%AD%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88+Branch+%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4%22%2C+variable%3Dself.auto_register_var)+self.auto_register_checkbox.grid(row%3D6%2C+column%3D0%2C+columnspan%3D3%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+%23+---+Booking+Details+Frame+---+booking_frame+%3D+ttk.LabelFrame(self.master%2C+text%3D%22%E0%B8%A3%E0%B8%B2%E0%B8%A2%E0%B8%A5%E0%B8%B0%E0%B9%80%E0%B8%AD%E0%B8%B5%E0%B8%A2%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%AD%E0%B8%87%22%2C+padding%3D%2210%22)+booking_frame.pack(padx%3D10%2C+pady%3D5%2C+fill%3D%22x%22)+ttk.Label(booking_frame%2C+text%3D%22Branch%3A%22).grid(row%3D0%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.branch_var+%3D+StringVar()+self.branch_options+%3D+%5B+%22Terminal+21%22%2C+%22Central+World%22%2C+%22Central+Ladprao%22%2C+%22Fashion+Island%22%2C+%22MEGABANGNA%22%2C+%22Siam+Center%22%2C+%22Siam+Square%22%2C+%22Emsphere%22%2C+%22Central+Pattaya%22%2C+%22Seacon+Square%22%2C+%22Central+Westgate%22%2C+%22Central+Chiangmai%22%2C+%22Icon+Siam%22+%5D+self.branch_dropdown+%3D+ttk.Combobox(booking_frame%2C+textvariable%3Dself.branch_var%2C+values%3Dself.branch_options%2C+state%3D%22readonly%22)+self.branch_dropdown.grid(row%3D0%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+ttk.Label(booking_frame%2C+text%3D%22Date+(YYYY-MM-DD)%3A%22).grid(row%3D1%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.date_entry+%3D+ttk.Entry(booking_frame)+self.date_entry.insert(0%2C+datetime.date.today().strftime(%22%25Y-%25m-%25d%22))+self.date_entry.grid(row%3D1%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+ttk.Label(booking_frame%2C+text%3D%22Time+(HH%3AMM)%3A%22).grid(row%3D2%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.time_var+%3D+StringVar()+self.time_options+%3D+%5B+%2210%3A30%22%2C+%2211%3A00%22%2C+%2211%3A30%22%2C+%2212%3A00%22%2C+%2212%3A30%22%2C+%2213%3A00%22%2C+%2213%3A30%22%2C+%2214%3A00%22%2C+%2214%3A30%22%2C+%2215%3A00%22%2C+%2215%3A30%22%2C+%2216%3A00%22%2C+%2216%3A30%22%2C+%2217%3A00%22%2C+%2217%3A30%22%2C+%2218%3A00%22%2C+%2218%3A30%22%2C+%2219%3A00%22%2C+%2219%3A30%22%2C+%2220%3A00%22%2C+%2220%3A30%22+%5D+self.time_dropdown+%3D+ttk.Combobox(booking_frame%2C+textvariable%3Dself.time_var%2C+values%3Dself.time_options%2C+state%3D%22readonly%22)+self.time_dropdown.grid(row%3D2%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+ttk.Label(booking_frame%2C+text%3D%22Quantity%3A%22).grid(row%3D3%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.quantity_entry+%3D+ttk.Entry(booking_frame)+self.quantity_entry.insert(0%2C+%221%22)+self.quantity_entry.grid(row%3D3%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+%23+---+Action+Buttons+---+button_frame+%3D+ttk.Frame(self.master%2C+padding%3D%2210%22)+button_frame.pack(padx%3D10%2C+pady%3D5%2C+fill%3D%22x%22)+self.start_button+%3D+ttk.Button(button_frame%2C+text%3D%22START%22%2C+command%3Dself.start_automation)+self.start_button.pack(side%3D%22left%22%2C+padx%3D5)+self.stop_button+%3D+ttk.Button(button_frame%2C+text%3D%22STOP%22%2C+command%3Dself.stop_automation%2C+state%3D%22disabled%22)+self.stop_button.pack(side%3D%22left%22%2C+padx%3D5)+%23+---+Log+Output+Area+---+ttk.Label(self.master%2C+text%3D%22Log+Output%3A%22).pack(padx%3D10%2C+anchor%3D%22w%22)+self.log_text+%3D+Text(self.master%2C+wrap%3D%22word%22%2C+height%3D15%2C+state%3D%22disabled%22)+self.log_text.pack(padx%3D10%2C+pady%3D5%2C+fill%3D%22both%22%2C+expand%3DTrue)+def+update_site_options(self)%3A+%22%22%22Updates+the+site+dropdown+based+on+the+selected+mode.%22%22%22+selected_mode+%3D+self.mode_var.get()+if+selected_mode+%3D%3D+%22test%22%3A+site_configs+%3D+self.app_config.get(%22test_mode_configs%22%2C+%7B%7D)+else%3A+%23+production+site_configs+%3D+self.app_config.get(%22production_mode_configs%22%2C+%7B%7D)+self.site_options+%3D+list(site_configs.keys())+self.site_dropdown%5B%27values%27%5D+%3D+self.site_options+if+self.site_options%3A+self.site_var.set(self.site_options%5B0%5D)+%23+Set+default+selected+site+else%3A+self.site_var.set(%22%22)+%23+Clear+if+no+options+def+toggle_profile_path_entry(self)%3A+%22%22%22Shows%2Fhides+the+profile+path+entry+based+on+checkbox.%22%22%22+if+self.use_profile_var.get()%3A+self.profile_path_label.grid()+self.profile_path_entry.grid()+else%3A+self.profile_path_label.grid_remove()+self.profile_path_entry.grid_remove()+def+on_site_selected(self%2C+event)%3A+%22%22%22Handles+site+selection+to+update+relevant+UI+elements+(if+needed).%22%22%22+selected_site_key+%3D+self.site_var.get()+selected_mode+%3D+self.mode_var.get()+site_config+%3D+self.app_config.get(f%22%7Bselected_mode%7D_mode_configs%22%2C+%7B%7D).get(selected_site_key%2C+%7B%7D)+%23+Example%3A+if+site_config+has+default+branch%2Fdate%2Ftime%2C+update+UI+fields+if+%22task_details%22+in+site_config%3A+if+%22branch%22+in+site_config%5B%22task_details%22%5D%3A+self.branch_var.set(site_config%5B%22task_details%22%5D%5B%22branch%22%5D)+if+%22booking_date%22+in+site_config%5B%22task_details%22%5D%3A+self.date_entry.delete(0%2C+END)+self.date_entry.insert(0%2C+site_config%5B%22task_details%22%5D%5B%22booking_date%22%5D)+if+%22booking_time%22+in+site_config%5B%22task_details%22%5D%3A+self.time_var.set(site_config%5B%22task_details%22%5D%5B%22booking_time%22%5D)+if+%22quantity%22+in+site_config%5B%22task_details%22%5D%3A+self.quantity_entry.delete(0%2C+END)+self.quantity_entry.insert(0%2C+str(site_config%5B%22task_details%22%5D%5B%22quantity%22%5D))+%23+Hide%2Fshow+branch%2Fdate%2Ftime%2Fquantity+fields+if+not+a+Pop+Mart+site+if+selected_site_key+in+%5B%22popmart_ithitec_test%22%2C+%22pmrocketbotautoq_test%22%2C+%22popmart_th_production%22%5D%3A+%23+Access+by+internal+name+or+create+a+reference+when+creating+the+frame+%23+For+simplicity%2C+assuming+booking_frame+is+the+second+LabelFrame+booking_frame+%3D+self.master.children.get(%27!labelframe2%27)+if+booking_frame%3A+for+widget+in+booking_frame.winfo_children()%3A+widget.grid()+%23+Show+all+else%3A+booking_frame+%3D+self.master.children.get(%27!labelframe2%27)+if+booking_frame%3A+for+widget+in+booking_frame.winfo_children()%3A+widget.grid_remove()+%23+Hide+all+(you+might+want+to+hide+only+specific+rows)+def+start_automation(self)%3A+self.stop_event.clear()+%23+Clear+stop+signal+for+new+run+self.log_text.config(state%3D%22normal%22)+self.log_text.delete(1.0%2C+END)+%23+Clear+previous+logs+self.log_text.config(state%3D%22disabled%22)+log_message(%22---+%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%95%E0%B9%89%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4+---%22)+%23+Get+values+from+GUI+selected_mode+%3D+self.mode_var.get()+selected_site_key+%3D+self.site_var.get()+debugging_port+%3D+self.port_entry.get()+browser_name+%3D+self.browser_var.get()+use_profile+%3D+self.use_profile_var.get()+profile_path+%3D+self.profile_path_entry.get()+if+use_profile+else+%22%22+auto_register_enabled+%3D+self.auto_register_var.get()+%23+Validate+inputs+if+not+selected_site_key%3A+messagebox.showerror(%22Input+Error%22%2C+%22%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81+Site+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%22)+return+try%3A+debugging_port+%3D+int(debugging_port)+except+ValueError%3A+messagebox.showerror(%22Input+Error%22%2C+%22Debugging+Port+%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B9%80%E0%B8%A5%E0%B8%82%22)+return+selected_site_config+%3D+self.app_config.get(f%22%7Bselected_mode%7D_mode_configs%22%2C+%7B%7D).get(selected_site_key%2C+%7B%7D)+if+not+selected_site_config%3A+messagebox.showerror(%22Config+Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+Site+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%22)+return+%23+Prepare+task_details+from+GUI+inputs+task_details+%3D+%7B%7D+if+selected_site_key+in+%5B%22popmart_ithitec_test%22%2C+%22pmrocketbotautoq_test%22%2C+%22popmart_th_production%22%5D%3A+task_details%5B%22branch%22%5D+%3D+self.branch_var.get()+task_details%5B%22booking_date%22%5D+%3D+self.date_entry.get()+task_details%5B%22booking_time%22%5D+%3D+self.time_var.get()+try%3A+task_details%5B%22quantity%22%5D+%3D+int(self.quantity_entry.get())+except+ValueError%3A+messagebox.showerror(%22Input+Error%22%2C+%22%E0%B8%88%E0%B8%B3%E0%B8%99%E0%B8%A7%E0%B8%99%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B9%80%E0%B8%A5%E0%B8%82%22)+return+if+not+task_details%5B%22branch%22%5D+or+not+task_details%5B%22booking_date%22%5D+or+not+task_details%5B%22booking_time%22%5D%3A+messagebox.showerror(%22Input+Error%22%2C+%22%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2%E0%B8%81%E0%B8%A3%E0%B8%AD%E0%B8%81%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%A1%E0%B8%B9%E0%B8%A5+Branch%2C+Date%2C+Time+%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A3%E0%B8%9A%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%99%22)+return+%23+Update+selected_site_config+with+live+GUI+inputs+selected_site_config%5B%22task_details%22%5D+%3D+task_details+%23+Determine+handler+function+and+auto_navigate+site_handler_function+%3D+None+auto_navigate_chosen+%3D+False+if+selected_mode+%3D%3D+%22test%22%3A+if+selected_site_key+%3D%3D+%22popmart_ithitec_test%22%3A+site_handler_function+%3D+test_sites.perform_popmart_ithitec_test+auto_navigate_chosen+%3D+True+elif+selected_site_key+%3D%3D+%22pmrocketbotautoq_test%22%3A+site_handler_function+%3D+test_sites.perform_pmrocketbotautoq_test+auto_navigate_chosen+%3D+True+elif+selected_mode+%3D%3D+%22production%22%3A+if+selected_site_key+%3D%3D+%22popmart_th_production%22%3A+site_handler_function+%3D+production_sites.perform_popmart_th_production+auto_navigate_chosen+%3D+False+%23+Production+mode%3A+user+navigates+manually+if+not+site_handler_function%3A+messagebox.showerror(%22Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B8%9F%E0%B8%B1%E0%B8%87%E0%B8%81%E0%B9%8C%E0%B8%8A%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+Site+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%22)+return+%23+Disable+START+button%2C+enable+STOP+button+self.start_button.config(state%3D%22disabled%22)+self.stop_button.config(state%3D%22normal%22)+%23+---+Launch+Browser+via+.bat+file+---+log_message(%22%5Cn-----------------------------------------------------------%22)+log_message(%22---+%E0%B8%82%E0%B8%B1%E0%B9%89%E0%B8%99%E0%B8%95%E0%B8%AD%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%95%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%A1%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C+(%E0%B8%97%E0%B8%B3%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%95%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%87)+---%22)+log_message(%22-----------------------------------------------------------%22)+log_message(f%221.+URL+%E0%B9%80%E0%B8%9B%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%A1%E0%B8%B2%E0%B8%A2%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+Task+%E0%B8%99%E0%B8%B5%E0%B9%89%E0%B8%84%E0%B8%B7%E0%B8%AD%3A+%7Bselected_site_config%5B%27url%27%5D%7D%22)+browser_bat_file+%3D+self.browser_options.get(browser_name)+if+not+browser_bat_file%3A+messagebox.showerror(%22Browser+Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+.bat+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%22)+self.stop_automation()+return+user_data_dir_to_pass+%3D+profile_path+if+use_profile+else+%22%22+log_message(f%22%5Cn2.+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C+%27%7Bbrowser_name%7D%27+%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+%27%7Bbrowser_bat_file%7D%27...%22)+log_message(f%22+(Port%3A+%7Bdebugging_port%7D%2C+Profile%3A+%7B%27Yes%27+if+user_data_dir_to_pass+else+%27No%27%7D)%22)+try%3A+%23+subprocess.Popen+will+run+the+.bat+file+in+a+new+CMD+window+%23+cwd%3D%27.%27+means+the+current+directory+where+main.py+is+located+subprocess.Popen(%5Bbrowser_bat_file%2C+str(debugging_port)%2C+user_data_dir_to_pass%5D%2C+shell%3DTrue%2C+cwd%3D%27.%27)+log_message(f%22+%E2%9C%85+%E0%B8%AA%E0%B8%B1%E0%B9%88%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C+%27%7Bbrowser_name%7D%27+%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+except+Exception+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B8%A3%E0%B8%B1%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+%27%7Bbrowser_bat_file%7D%27+%E0%B9%84%E0%B8%94%E0%B9%89%3A+%7Be%7D%22)+messagebox.showerror(%22Launch+Error%22%2C+f%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B8%A3%E0%B8%B1%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+%7Bbrowser_bat_file%7D+%E0%B9%84%E0%B8%94%E0%B9%89%22)+self.stop_automation()+return+log_message(%22%5Cn3.+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%A3%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B8%82%E0%B8%B6%E0%B9%89%E0%B8%99%E0%B8%A1%E0%B8%B2%E0%B9%80%E0%B8%AD%E0%B8%87%22)+if+auto_navigate_chosen%3A+log_message(f%22+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B8%A3%E0%B8%A1%E0%B8%88%E0%B8%B0%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%84%E0%B8%9B%E0%B8%A2%E0%B8%B1%E0%B8%87+%7Bselected_site_config%5B%27url%27%5D%7D+%E0%B9%80%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%84%E0%B8%94%E0%B9%89%22)+else%3A+%23+Production+Mode+log_message(f%22+%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2+Copy+URL+%E0%B8%94%E0%B9%89%E0%B8%B2%E0%B8%99%E0%B8%9A%E0%B8%99%E0%B9%84%E0%B8%9B%E0%B8%A7%E0%B8%B2%E0%B8%87%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%3A+%7Bselected_site_config%5B%27url%27%5D%7D%22)+log_message(%22+%E0%B8%AB%E0%B8%B2%E0%B8%81%E0%B8%A1%E0%B8%B5+CAPTCHA+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+%27Unusual+Traffic%27+%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B9%81%E0%B8%81%E0%B9%89%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%95%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2.%22)+log_message(%224.+%E0%B9%80%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%E0%B9%80%E0%B8%A7%E0%B9%87%E0%B8%9A%E0%B8%9E%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A1%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+**%E0%B8%81%E0%B8%94%E0%B8%9B%E0%B8%B8%E0%B9%88%E0%B8%A1+%27Start+Task%27+%E0%B9%83%E0%B8%99+GUI+%E0%B8%99%E0%B8%B5%E0%B9%89**+%E0%B9%80%E0%B8%9E%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3+Task...%22)+%23+Change+START+button+text+and+command+to+%22Start+Task%22+self.start_button.config(text%3D%22Start+Task%22%2C+command%3Dlambda%3A+self.start_task_after_browser_ready(+selected_site_config%2C+site_handler_function%2C+debugging_port%2C+browser_name%2C+auto_navigate_chosen%2C+auto_register_enabled+))+def+start_task_after_browser_ready(self%2C+selected_site_config%2C+site_handler_function%2C+debugging_port%2C+browser_name%2C+auto_navigate_chosen%2C+auto_register_enabled)%3A+%22%22%22Starts+the+automation+task+in+a+new+thread+after+browser+is+ready.%22%22%22+self.start_button.config(state%3D%22disabled%22%2C+text%3D%22Running...%22)+self.stop_button.config(state%3D%22normal%22)+log_message(%22%5Cn---+%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%81%E0%B8%94+%27Start+Task%27+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1+Task+---%22)+%23+Start+the+automation+in+a+new+thread+task_thread+%3D+threading.Thread(target%3Drun_task_in_thread%2C+args%3D(+selected_site_config%2C+site_handler_function%2C+debugging_port%2C+browser_name%2C+auto_navigate_chosen%2C+auto_register_enabled+))+self.running_threads.append(task_thread)+task_thread.start()+%23+Reset+START+button+after+a+short+delay+(or+when+thread+completes)+%23+For+simplicity%2C+we%27ll+re-enable+after+a+short+delay%2C+or+you+can+check+thread+status+self.master.after(100%2C+self.check_threads_status)+%23+Check+status+periodically+def+stop_automation(self)%3A+log_message(%22%5Cn---+%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%84%E0%B8%B3%E0%B8%AA%E0%B8%B1%E0%B9%88%E0%B8%87%E0%B8%AB%E0%B8%A2%E0%B8%B8%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99+---%22)+self.stop_event.set()+%23+Set+stop+signal+%23+Wait+for+threads+to+finish+(optional%2C+can+block+GUI)+%23+For+simplicity%2C+just+disable+buttons+self.start_button.config(state%3D%22normal%22%2C+text%3D%22START%22)+self.stop_button.config(state%3D%22disabled%22)+log_message(%22---+%E0%B8%AA%E0%B8%B4%E0%B9%89%E0%B8%99%E0%B8%AA%E0%B8%B8%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4+---%22)+def+update_log(self)%3A+%22%22%22Periodically+checks+the+log+queue+and+updates+the+Text+widget.%22%22%22+while+not+log_queue.empty()%3A+message+%3D+log_queue.get()+self.log_text.config(state%3D%22normal%22)+self.log_text.insert(END%2C+message+%2B+%22%5Cn%22)+self.log_text.see(END)+%23+Scroll+to+the+end+self.log_text.config(state%3D%22disabled%22)+self.master.after(100%2C+self.update_log)+%23+Check+again+after+100ms+def+check_threads_status(self)%3A+%22%22%22Checks+if+all+threads+have+finished+and+updates+GUI+state.%22%22%22+all_finished+%3D+True+for+thread+in+self.running_threads%3A+if+thread.is_alive()%3A+all_finished+%3D+False+break+if+all_finished%3A+self.start_button.config(state%3D%22normal%22%2C+text%3D%22START%22)+self.stop_button.config(state%3D%22disabled%22)+self.running_threads+%3D+%5B%5D+%23+Clear+the+list+log_message(%22---+%E0%B8%97%E0%B8%B8%E0%B8%81+Task+%E0%B9%80%E0%B8%AA%E0%B8%A3%E0%B9%87%E0%B8%88%E0%B8%AA%E0%B8%B4%E0%B9%89%E0%B8%99%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+---%22)+else%3A+self.master.after(500%2C+self.check_threads_status)+%23+Check+again+after+500ms+%23+---+Main+Application+Execution+---+if+__name__+%3D%3D+%22__main__%22%3A+root+%3D+Tk()+load_config()+%23+Load+config+before+creating+GUI+%23+Initial+check+for+windows_username+windows_username+%3D+USER_APP_CONFIG.get(%22windows_username%22)+if+not+windows_username+or+windows_username+%3D%3D+%22YourUsernameHere%22%3A+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%82%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+user_config.json+%E0%B9%80%E0%B8%9E%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%83%E0%B8%AA%E0%B9%88%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89+(Username)+%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B8%AD%E0%B8%A1%E0%B8%9E%E0%B8%B4%E0%B8%A7%E0%B9%80%E0%B8%95%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+root.destroy()+%23+Close+GUI+if+config+is+bad+else%3A+app+%3D+AutoBookingApp(root)+root.mainloop()&oq=import+json+import+time+import+threading+%23+%E0%B9%80%E0%B8%9E%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%99%E0%B8%B3%E0%B9%80%E0%B8%82%E0%B9%89%E0%B8%B2+threading+import+datetime+import+calendar+import+subprocess+from+tkinter+import+Tk%2C+Label%2C+Button%2C+Text%2C+END%2C+Toplevel%2C+ttk%2C+messagebox%2C+StringVar%2C+BooleanVar+from+queue+import+Queue+from+playwright.sync_api+import+sync_playwright%2C+Page%2C+BrowserContext%2C+BrowserType+from+playwright.sync_api+import+Error+as+PlaywrightError+from+site_handlers+import+test_sites+from+site_handlers+import+production_sites+%23+---+Global+Variables+for+GUI+and+Automation+---+APP_CONFIG+%3D+%7B%7D+USER_APP_CONFIG+%3D+%7B%7D+log_queue+%3D+Queue()+stop_event+%3D+threading.Event()+%23+---+Configuration+Loading+---+CONFIG_FILE_NAME+%3D+%27config.json%27+USER_CONFIG_FILE_NAME+%3D+%27user_config.json%27+def+load_config()%3A+%22%22%22Loads+configuration+from+config.json+and+user_config.json.%22%22%22+global+APP_CONFIG%2C+USER_APP_CONFIG+try%3A+with+open(CONFIG_FILE_NAME%2C+%27r%27%2C+encoding%3D%27utf-8%27)+as+f%3A+APP_CONFIG+%3D+json.load(f)+log_message(f%22%E2%9C%85+%E0%B9%82%E0%B8%AB%E0%B8%A5%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%88%E0%B8%B2%E0%B8%81+%27%7BCONFIG_FILE_NAME%7D%27+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+with+open(USER_CONFIG_FILE_NAME%2C+%27r%27%2C+encoding%3D%27utf-8%27)+as+f%3A+USER_APP_CONFIG+%3D+json.load(f)+log_message(f%22%E2%9C%85+%E0%B9%82%E0%B8%AB%E0%B8%A5%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%88%E0%B8%B2%E0%B8%81+%27%7BUSER_CONFIG_FILE_NAME%7D%27+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+except+FileNotFoundError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json%3A+%7Be%7D%22)+log_message(%22+++%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A%E0%B8%A7%E0%B9%88%E0%B8%B2%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C%E0%B8%97%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%AA%E0%B8%AD%E0%B8%87%E0%B8%AD%E0%B8%A2%E0%B8%B9%E0%B9%88%E0%B9%83%E0%B8%99%E0%B9%82%E0%B8%9F%E0%B8%A5%E0%B9%80%E0%B8%94%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%94%E0%B8%B5%E0%B8%A2%E0%B8%A7%E0%B8%81%E0%B8%B1%E0%B8%99%E0%B8%81%E0%B8%B1%E0%B8%9A+main.py+%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%A1%E0%B8%B5%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json%22)+exit()+except+json.JSONDecodeError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B8%A3%E0%B8%B9%E0%B8%9B%E0%B9%81%E0%B8%9A%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87+(JSON+Error)%3A+%7Be%7D%22)+log_message(%22+++%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A+syntax+%E0%B9%83%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+JSON+%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B8%B8%E0%B8%93%22)+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B8%A3%E0%B8%B9%E0%B8%9B%E0%B9%81%E0%B8%9A%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+exit()+except+ValueError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%83%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%3A+%7Be%7D%22)+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B9%83%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+config.json+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+user_config.json+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+exit()+%23+---+Logging+Function+for+GUI+---+def+log_message(message)%3A+%22%22%22Puts+a+message+into+the+log+queue+to+be+displayed+in+the+GUI.%22%22%22+log_queue.put(message)+%23+---+Playwright+Connection+Function+---+def+connect_to_existing_browser(playwright_instance%3A+sync_playwright%2C+debugging_port%3A+int%2C+target_url%3A+str%2C+auto_navigate%3A+bool+%3D+False)+-%3E+Page%3A+%22%22%22+Connects+to+an+existing+browser+via+Debugging+Port.+Navigates+automatically+if+auto_navigate+is+True.+%22%22%22+log_message(f%22%5Cn---+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%9E%E0%B8%A2%E0%B8%B2%E0%B8%A2%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%9C%E0%B9%88%E0%B8%B2%E0%B8%99+Debugging+Port+%7Bdebugging_port%7D+---%22)+page+%3D+None+try%3A+browser+%3D+playwright_instance.chromium.connect_over_cdp(f%22http%3A%2F%2F127.0.0.1%3A%7Bdebugging_port%7D%22)+pages+%3D+browser.contexts%5B0%5D.pages+if+not+pages%3A+raise+Exception(%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A+Page+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B8%AD%E0%B8%A2%E0%B8%B9%E0%B9%88%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%22)+page+%3D+pages%5B0%5D+page.evaluate(%22Object.defineProperty(navigator%2C+%27webdriver%27%2C+%7Bget%3A+()+%3D%3E+undefined%7D)%22)+log_message(f%22%E2%9C%85+%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88+Port+%7Bdebugging_port%7D+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+current_url+%3D+page.url+log_message(f%22+++URL+%E0%B8%9B%E0%B8%B1%E0%B8%88%E0%B8%88%E0%B8%B8%E0%B8%9A%E0%B8%B1%E0%B8%99%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%3A+%7Bcurrent_url%7D%22)+if+auto_navigate%3A+if+target_url+not+in+current_url%3A+log_message(f%22+++%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%84%E0%B8%9B%E0%B8%97%E0%B8%B5%E0%B9%88%3A+%7Btarget_url%7D+%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4...%22)+page.goto(target_url%2C+wait_until%3D%27domcontentloaded%27)+log_message(f%22+++%E2%9C%85+%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%84%E0%B8%9B%E0%B8%A2%E0%B8%B1%E0%B8%87+%7Btarget_url%7D+%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7.%22)+else%3A+log_message(%22+++%E2%9C%85+URL+%E0%B8%95%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%AD%E0%B8%A2%E0%B8%B9%E0%B9%88%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+(%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%8B%E0%B9%89%E0%B8%B3).%22)+else%3A+if+target_url+not+in+current_url%3A+log_message(f%22+++%E2%9A%A0%EF%B8%8F+URL+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%95%E0%B8%A3%E0%B8%87%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81+(%7Btarget_url%7D)%22)+log_message(f%22+++%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%84%E0%B8%9B%E0%B8%97%E0%B8%B5%E0%B9%88%3A+%7Btarget_url%7D+%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%95%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%87+%E0%B8%96%E0%B9%89%E0%B8%B2%E0%B8%A2%E0%B8%B1%E0%B8%87%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+start_time+%3D+time.time()+while+target_url+not+in+page.url+and+time.time()+-+start_time+%3C+300%3A+time.sleep(2)+log_message(f%22+++%5B%E0%B8%A3%E0%B8%AD%5D+URL+%E0%B8%A2%E0%B8%B1%E0%B8%87%E0%B8%84%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%3A+%7Bpage.url%7D%22)+if+stop_event.is_set()%3A+%23+Check+for+stop+signal+raise+Exception(%22%E0%B8%AB%E0%B8%A2%E0%B8%B8%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%95%E0%B8%B2%E0%B8%A1%E0%B8%84%E0%B8%B3%E0%B8%AA%E0%B8%B1%E0%B9%88%E0%B8%87%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%22)+if+target_url+not+in+page.url%3A+log_message(%22%E2%9D%8C+%E0%B8%AB%E0%B8%A1%E0%B8%94%E0%B9%80%E0%B8%A7%E0%B8%A5%E0%B8%B2%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+URL+%E0%B8%A2%E0%B8%B1%E0%B8%87%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B8%A3%E0%B8%A1%E0%B8%88%E0%B8%B0%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B9%88%E0%B8%AD%22)+raise+Exception(%22URL+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B9%84%E0%B8%9B%E0%B8%A2%E0%B8%B1%E0%B8%87+URL+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%22)+else%3A+log_message(%22+++%E2%9C%85+URL+%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7!+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B9%88%E0%B8%AD%22)+return+page+except+PlaywrightError+as+e%3A+log_message(f%22%E2%9D%8C+ERROR+(Playwright)%3A+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%84%E0%B8%94%E0%B9%89%3A+%7Be%7D%22)+log_message(%22+++%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%95%E0%B8%A3%E0%B8%A7%E0%B8%88%E0%B8%AA%E0%B8%AD%E0%B8%9A%3A%22)+log_message(f%22+++1.+%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94+Google+Chrome%2FEdge+%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2+--remote-debugging-port%3D%7Bdebugging_port%7D+%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B8%A2%E0%B8%B1%E0%B8%87%3F%22)+log_message(%22++++++%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B8%AD%E0%B8%A2%E0%B9%88%E0%B8%B2%E0%B8%87%3A+%5C%22C%3A%5C%5CProgram+Files%5C%5CGoogle%5C%5CChrome%5C%5CApplication%5C%5Cchrome.exe%5C%22+--remote-debugging-port%3D9222%22)+log_message(%22+++2.+%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B8%A3%E0%B8%B1%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%9E%E0%B8%B5%E0%B8%A2%E0%B8%87+Instance+%E0%B9%80%E0%B8%94%E0%B8%B5%E0%B8%A2%E0%B8%A7%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%83%E0%B8%8A%E0%B9%89+Port+%E0%B8%99%E0%B8%B5%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%88%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD%E0%B9%84%E0%B8%A1%E0%B9%88%3F%22)+log_message(%22+++3.+%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%AD%E0%B8%B2%E0%B8%88%E0%B8%9A%E0%B8%A5%E0%B9%87%E0%B8%AD%E0%B8%81%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B8%9C%E0%B9%88%E0%B8%B2%E0%B8%99+Debugging+Protocol%22)+raise+except+Exception+as+e%3A+log_message(f%22%E2%9D%8C+ERROR+(%E0%B8%97%E0%B8%B1%E0%B9%88%E0%B8%A7%E0%B9%84%E0%B8%9B)%3A+%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%9E%E0%B8%A5%E0%B8%B2%E0%B8%94%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%84%E0%B8%B2%E0%B8%94%E0%B8%84%E0%B8%B4%E0%B8%94%E0%B9%83%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%3A+%7Be%7D%22)+raise+%23+---+Worker+Thread+Function+---+def+run_task_in_thread(site_config_data%2C+handler_function%2C+debugging_port%3A+int%2C+browser_name%3A+str%2C+auto_navigate%3A+bool%2C+auto_register_enabled%3A+bool)%3A+%22%22%22+Function+to+run+the+automation+task+in+a+separate+thread.+Handles+Playwright+setup+and+teardown+within+the+thread.+%22%22%22+session_name+%3D+site_config_data.get(%22session_name%22%2C+%22Unnamed+Session%22)+target_url+%3D+site_config_data%5B%22url%22%5D+log_message(f%22%5Cn---+%5BThread%5D+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%95%E0%B9%89%E0%B8%99+Thread+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+---%22)+page+%3D+None+context+%3D+None+try%3A+with+sync_playwright()+as+p%3A+context+%3D+connect_to_existing_browser(p%2C+debugging_port%2C+target_url%2C+auto_navigate)+page+%3D+context.new_page()+page.evaluate(%22Object.defineProperty(navigator%2C+%27webdriver%27%2C+%7Bget%3A+()+%3D%3E+undefined%7D)%22)+%23+Pass+auto_register_enabled+to+the+handler+function+success+%3D+handler_function(page%2C+site_config_data%2C+auto_register_enabled%2C+stop_event)+if+success%3A+log_message(f%22%E2%9C%85+%5BThread%5D+Task+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%A3%E0%B9%87%E0%B8%88!%22)+else%3A+log_message(f%22%E2%9D%8C+%5BThread%5D+Task+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B3%E0%B9%80%E0%B8%A3%E0%B9%87%E0%B8%88!%22)+except+Exception+as+e%3A+log_message(f%22%E2%9D%8C+%5BThread%5D+%E0%B9%80%E0%B8%81%E0%B8%B4%E0%B8%94%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%9C%E0%B8%B4%E0%B8%94%E0%B8%9E%E0%B8%A5%E0%B8%B2%E0%B8%94%E0%B9%83%E0%B8%99+Thread+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27.+%E0%B8%A3%E0%B8%B2%E0%B8%A2%E0%B8%A5%E0%B8%B0%E0%B9%80%E0%B8%AD%E0%B8%B5%E0%B8%A2%E0%B8%94%3A+%7Be%7D%22)+finally%3A+if+context%3A+context.close()+log_message(f%22---+%5BThread%5D+%E0%B8%9B%E0%B8%B4%E0%B8%94+Page+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+---%22)+log_message(f%22---+%5BThread%5D+Task+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+%27%7Bsession_name%7D%27+%E0%B8%88%E0%B8%9A%E0%B8%A5%E0%B8%87%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+---%22)+%23+Signal+main+thread+if+all+tasks+are+done+(optional%2C+for+GUI+state)+%23+---+GUI+Application+Class+---+class+AutoBookingApp%3A+def+__init__(self%2C+master)%3A+self.master+%3D+master+master.title(%22Pop+Mart+Auto+Booking+(GUI)%22)+master.geometry(%22800x700%22)+%23+%E0%B8%81%E0%B8%B3%E0%B8%AB%E0%B8%99%E0%B8%94%E0%B8%82%E0%B8%99%E0%B8%B2%E0%B8%94%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%95%E0%B9%89%E0%B8%99%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%E0%B8%95%E0%B9%88%E0%B8%B2%E0%B8%87+self.running_threads+%3D+%5B%5D+%23+Keep+track+of+active+threads+self.stop_event+%3D+threading.Event()+%23+For+stopping+threads+self.app_config+%3D+APP_CONFIG+self.user_app_config+%3D+USER_APP_CONFIG+self.windows_username+%3D+self.user_app_config.get(%22windows_username%22%2C+%22YourUsernameHere%22)+self.create_widgets()+self.update_log()+%23+Start+updating+log+messages+def+create_widgets(self)%3A+%23+---+Frame+for+Controls+---+control_frame+%3D+ttk.LabelFrame(self.master%2C+text%3D%22%E0%B8%84%E0%B8%A7%E0%B8%9A%E0%B8%84%E0%B8%B8%E0%B8%A1%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%22%2C+padding%3D%2210%22)+control_frame.pack(padx%3D10%2C+pady%3D10%2C+fill%3D%22x%22)+%23+Mode+Selection+ttk.Label(control_frame%2C+text%3D%22%E0%B9%82%E0%B8%AB%E0%B8%A1%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%3A%22).grid(row%3D0%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.mode_var+%3D+StringVar(value%3D%22test%22)+self.mode_test_radio+%3D+ttk.Radiobutton(control_frame%2C+text%3D%22Test%22%2C+variable%3Dself.mode_var%2C+value%3D%22test%22%2C+command%3Dself.update_site_options)+self.mode_test_radio.grid(row%3D0%2C+column%3D1%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.mode_prod_radio+%3D+ttk.Radiobutton(control_frame%2C+text%3D%22Production%22%2C+variable%3Dself.mode_var%2C+value%3D%22production%22%2C+command%3Dself.update_site_options)+self.mode_prod_radio.grid(row%3D0%2C+column%3D2%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+%23+Site+Selection+ttk.Label(control_frame%2C+text%3D%22%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81+Site%3A%22).grid(row%3D1%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.site_options+%3D+%5B%5D+self.site_var+%3D+StringVar()+self.site_dropdown+%3D+ttk.Combobox(control_frame%2C+textvariable%3Dself.site_var%2C+state%3D%22readonly%22)+self.site_dropdown.grid(row%3D1%2C+column%3D1%2C+columnspan%3D2%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+self.site_dropdown.bind(%22%3C%3CComboboxSelected%3E%3E%22%2C+self.on_site_selected)+self.update_site_options()+%23+Populate+initial+site+options+%23+Browser+Selection+ttk.Label(control_frame%2C+text%3D%22%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%3A%22).grid(row%3D2%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.browser_options+%3D+%7B+%22Google+Chrome%22%3A+%22start_chrome_debug.bat%22%2C+%22Microsoft+Edge%22%3A+%22start_edge_debug.bat%22%2C+%23+%22Mozilla+Firefox%22%3A+r%22C%3A%5CProgram+Files%5CMozilla+Firefox%5Cfirefox.exe%22+%23+Firefox+not+supported+by+connect_over_cdp+%7D+self.browser_var+%3D+StringVar(value%3Dlist(self.browser_options.keys())%5B0%5D)+self.browser_dropdown+%3D+ttk.Combobox(control_frame%2C+textvariable%3Dself.browser_var%2C+values%3Dlist(self.browser_options.keys())%2C+state%3D%22readonly%22)+self.browser_dropdown.grid(row%3D2%2C+column%3D1%2C+columnspan%3D2%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+%23+Debugging+Port+ttk.Label(control_frame%2C+text%3D%22Debugging+Port%3A%22).grid(row%3D3%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.port_entry+%3D+ttk.Entry(control_frame)+self.port_entry.insert(0%2C+%229222%22)+self.port_entry.grid(row%3D3%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+%23+Use+Profile+Checkbox+self.use_profile_var+%3D+BooleanVar(value%3DTrue)+self.use_profile_checkbox+%3D+ttk.Checkbutton(control_frame%2C+text%3D%22%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B9%80%E0%B8%94%E0%B8%B4%E0%B8%A1%22%2C+variable%3Dself.use_profile_var%2C+command%3Dself.toggle_profile_path_entry)+self.use_profile_checkbox.grid(row%3D4%2C+column%3D0%2C+columnspan%3D2%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+%23+Profile+Path+Entry+(hidden+by+default)+self.profile_path_label+%3D+ttk.Label(control_frame%2C+text%3D%22User+Profile+Path%3A%22)+self.profile_path_label.grid(row%3D5%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.profile_path_entry+%3D+ttk.Entry(control_frame)+self.profile_path_entry.grid(row%3D5%2C+column%3D1%2C+columnspan%3D2%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+self.profile_path_entry.insert(0%2C+f%22C%3A%5C%5CUsers%5C%5C%7Bself.windows_username%7D%5C%5CAppData%5C%5CLocal%5C%5CGoogle%5C%5CChrome%5C%5CUser+Data%5C%5CDefault%22)+self.toggle_profile_path_entry()+%23+Set+initial+state+%23+Auto-Register%2FRetry+Branch+Checkbox+self.auto_register_var+%3D+BooleanVar(value%3DTrue)+self.auto_register_checkbox+%3D+ttk.Checkbutton(control_frame%2C+text%3D%22%E0%B8%84%E0%B8%A5%E0%B8%B4%E0%B8%81+Register%2F%E0%B8%A5%E0%B8%AD%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B8%A1%E0%B9%88+Branch+%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4%22%2C+variable%3Dself.auto_register_var)+self.auto_register_checkbox.grid(row%3D6%2C+column%3D0%2C+columnspan%3D3%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+%23+---+Booking+Details+Frame+---+booking_frame+%3D+ttk.LabelFrame(self.master%2C+text%3D%22%E0%B8%A3%E0%B8%B2%E0%B8%A2%E0%B8%A5%E0%B8%B0%E0%B9%80%E0%B8%AD%E0%B8%B5%E0%B8%A2%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%88%E0%B8%AD%E0%B8%87%22%2C+padding%3D%2210%22)+booking_frame.pack(padx%3D10%2C+pady%3D5%2C+fill%3D%22x%22)+ttk.Label(booking_frame%2C+text%3D%22Branch%3A%22).grid(row%3D0%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.branch_var+%3D+StringVar()+self.branch_options+%3D+%5B+%22Terminal+21%22%2C+%22Central+World%22%2C+%22Central+Ladprao%22%2C+%22Fashion+Island%22%2C+%22MEGABANGNA%22%2C+%22Siam+Center%22%2C+%22Siam+Square%22%2C+%22Emsphere%22%2C+%22Central+Pattaya%22%2C+%22Seacon+Square%22%2C+%22Central+Westgate%22%2C+%22Central+Chiangmai%22%2C+%22Icon+Siam%22+%5D+self.branch_dropdown+%3D+ttk.Combobox(booking_frame%2C+textvariable%3Dself.branch_var%2C+values%3Dself.branch_options%2C+state%3D%22readonly%22)+self.branch_dropdown.grid(row%3D0%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+ttk.Label(booking_frame%2C+text%3D%22Date+(YYYY-MM-DD)%3A%22).grid(row%3D1%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.date_entry+%3D+ttk.Entry(booking_frame)+self.date_entry.insert(0%2C+datetime.date.today().strftime(%22%25Y-%25m-%25d%22))+self.date_entry.grid(row%3D1%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+ttk.Label(booking_frame%2C+text%3D%22Time+(HH%3AMM)%3A%22).grid(row%3D2%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.time_var+%3D+StringVar()+self.time_options+%3D+%5B+%2210%3A30%22%2C+%2211%3A00%22%2C+%2211%3A30%22%2C+%2212%3A00%22%2C+%2212%3A30%22%2C+%2213%3A00%22%2C+%2213%3A30%22%2C+%2214%3A00%22%2C+%2214%3A30%22%2C+%2215%3A00%22%2C+%2215%3A30%22%2C+%2216%3A00%22%2C+%2216%3A30%22%2C+%2217%3A00%22%2C+%2217%3A30%22%2C+%2218%3A00%22%2C+%2218%3A30%22%2C+%2219%3A00%22%2C+%2219%3A30%22%2C+%2220%3A00%22%2C+%2220%3A30%22+%5D+self.time_dropdown+%3D+ttk.Combobox(booking_frame%2C+textvariable%3Dself.time_var%2C+values%3Dself.time_options%2C+state%3D%22readonly%22)+self.time_dropdown.grid(row%3D2%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+ttk.Label(booking_frame%2C+text%3D%22Quantity%3A%22).grid(row%3D3%2C+column%3D0%2C+sticky%3D%22w%22%2C+padx%3D5%2C+pady%3D2)+self.quantity_entry+%3D+ttk.Entry(booking_frame)+self.quantity_entry.insert(0%2C+%221%22)+self.quantity_entry.grid(row%3D3%2C+column%3D1%2C+sticky%3D%22ew%22%2C+padx%3D5%2C+pady%3D2)+%23+---+Action+Buttons+---+button_frame+%3D+ttk.Frame(self.master%2C+padding%3D%2210%22)+button_frame.pack(padx%3D10%2C+pady%3D5%2C+fill%3D%22x%22)+self.start_button+%3D+ttk.Button(button_frame%2C+text%3D%22START%22%2C+command%3Dself.start_automation)+self.start_button.pack(side%3D%22left%22%2C+padx%3D5)+self.stop_button+%3D+ttk.Button(button_frame%2C+text%3D%22STOP%22%2C+command%3Dself.stop_automation%2C+state%3D%22disabled%22)+self.stop_button.pack(side%3D%22left%22%2C+padx%3D5)+%23+---+Log+Output+Area+---+ttk.Label(self.master%2C+text%3D%22Log+Output%3A%22).pack(padx%3D10%2C+anchor%3D%22w%22)+self.log_text+%3D+Text(self.master%2C+wrap%3D%22word%22%2C+height%3D15%2C+state%3D%22disabled%22)+self.log_text.pack(padx%3D10%2C+pady%3D5%2C+fill%3D%22both%22%2C+expand%3DTrue)+def+update_site_options(self)%3A+%22%22%22Updates+the+site+dropdown+based+on+the+selected+mode.%22%22%22+selected_mode+%3D+self.mode_var.get()+if+selected_mode+%3D%3D+%22test%22%3A+site_configs+%3D+self.app_config.get(%22test_mode_configs%22%2C+%7B%7D)+else%3A+%23+production+site_configs+%3D+self.app_config.get(%22production_mode_configs%22%2C+%7B%7D)+self.site_options+%3D+list(site_configs.keys())+self.site_dropdown%5B%27values%27%5D+%3D+self.site_options+if+self.site_options%3A+self.site_var.set(self.site_options%5B0%5D)+%23+Set+default+selected+site+else%3A+self.site_var.set(%22%22)+%23+Clear+if+no+options+def+toggle_profile_path_entry(self)%3A+%22%22%22Shows%2Fhides+the+profile+path+entry+based+on+checkbox.%22%22%22+if+self.use_profile_var.get()%3A+self.profile_path_label.grid()+self.profile_path_entry.grid()+else%3A+self.profile_path_label.grid_remove()+self.profile_path_entry.grid_remove()+def+on_site_selected(self%2C+event)%3A+%22%22%22Handles+site+selection+to+update+relevant+UI+elements+(if+needed).%22%22%22+selected_site_key+%3D+self.site_var.get()+selected_mode+%3D+self.mode_var.get()+site_config+%3D+self.app_config.get(f%22%7Bselected_mode%7D_mode_configs%22%2C+%7B%7D).get(selected_site_key%2C+%7B%7D)+%23+Example%3A+if+site_config+has+default+branch%2Fdate%2Ftime%2C+update+UI+fields+if+%22task_details%22+in+site_config%3A+if+%22branch%22+in+site_config%5B%22task_details%22%5D%3A+self.branch_var.set(site_config%5B%22task_details%22%5D%5B%22branch%22%5D)+if+%22booking_date%22+in+site_config%5B%22task_details%22%5D%3A+self.date_entry.delete(0%2C+END)+self.date_entry.insert(0%2C+site_config%5B%22task_details%22%5D%5B%22booking_date%22%5D)+if+%22booking_time%22+in+site_config%5B%22task_details%22%5D%3A+self.time_var.set(site_config%5B%22task_details%22%5D%5B%22booking_time%22%5D)+if+%22quantity%22+in+site_config%5B%22task_details%22%5D%3A+self.quantity_entry.delete(0%2C+END)+self.quantity_entry.insert(0%2C+str(site_config%5B%22task_details%22%5D%5B%22quantity%22%5D))+%23+Hide%2Fshow+branch%2Fdate%2Ftime%2Fquantity+fields+if+not+a+Pop+Mart+site+if+selected_site_key+in+%5B%22popmart_ithitec_test%22%2C+%22pmrocketbotautoq_test%22%2C+%22popmart_th_production%22%5D%3A+%23+Access+by+internal+name+or+create+a+reference+when+creating+the+frame+%23+For+simplicity%2C+assuming+booking_frame+is+the+second+LabelFrame+booking_frame+%3D+self.master.children.get(%27!labelframe2%27)+if+booking_frame%3A+for+widget+in+booking_frame.winfo_children()%3A+widget.grid()+%23+Show+all+else%3A+booking_frame+%3D+self.master.children.get(%27!labelframe2%27)+if+booking_frame%3A+for+widget+in+booking_frame.winfo_children()%3A+widget.grid_remove()+%23+Hide+all+(you+might+want+to+hide+only+specific+rows)+def+start_automation(self)%3A+self.stop_event.clear()+%23+Clear+stop+signal+for+new+run+self.log_text.config(state%3D%22normal%22)+self.log_text.delete(1.0%2C+END)+%23+Clear+previous+logs+self.log_text.config(state%3D%22disabled%22)+log_message(%22---+%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%95%E0%B9%89%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4+---%22)+%23+Get+values+from+GUI+selected_mode+%3D+self.mode_var.get()+selected_site_key+%3D+self.site_var.get()+debugging_port+%3D+self.port_entry.get()+browser_name+%3D+self.browser_var.get()+use_profile+%3D+self.use_profile_var.get()+profile_path+%3D+self.profile_path_entry.get()+if+use_profile+else+%22%22+auto_register_enabled+%3D+self.auto_register_var.get()+%23+Validate+inputs+if+not+selected_site_key%3A+messagebox.showerror(%22Input+Error%22%2C+%22%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81+Site+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B8%81%E0%B8%B2%E0%B8%A3%22)+return+try%3A+debugging_port+%3D+int(debugging_port)+except+ValueError%3A+messagebox.showerror(%22Input+Error%22%2C+%22Debugging+Port+%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B9%80%E0%B8%A5%E0%B8%82%22)+return+selected_site_config+%3D+self.app_config.get(f%22%7Bselected_mode%7D_mode_configs%22%2C+%7B%7D).get(selected_site_key%2C+%7B%7D)+if+not+selected_site_config%3A+messagebox.showerror(%22Config+Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%95%E0%B8%B1%E0%B9%89%E0%B8%87%E0%B8%84%E0%B9%88%E0%B8%B2%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+Site+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%22)+return+%23+Prepare+task_details+from+GUI+inputs+task_details+%3D+%7B%7D+if+selected_site_key+in+%5B%22popmart_ithitec_test%22%2C+%22pmrocketbotautoq_test%22%2C+%22popmart_th_production%22%5D%3A+task_details%5B%22branch%22%5D+%3D+self.branch_var.get()+task_details%5B%22booking_date%22%5D+%3D+self.date_entry.get()+task_details%5B%22booking_time%22%5D+%3D+self.time_var.get()+try%3A+task_details%5B%22quantity%22%5D+%3D+int(self.quantity_entry.get())+except+ValueError%3A+messagebox.showerror(%22Input+Error%22%2C+%22%E0%B8%88%E0%B8%B3%E0%B8%99%E0%B8%A7%E0%B8%99%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%95%E0%B8%B1%E0%B8%A7%E0%B9%80%E0%B8%A5%E0%B8%82%22)+return+if+not+task_details%5B%22branch%22%5D+or+not+task_details%5B%22booking_date%22%5D+or+not+task_details%5B%22booking_time%22%5D%3A+messagebox.showerror(%22Input+Error%22%2C+%22%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2%E0%B8%81%E0%B8%A3%E0%B8%AD%E0%B8%81%E0%B8%82%E0%B9%89%E0%B8%AD%E0%B8%A1%E0%B8%B9%E0%B8%A5+Branch%2C+Date%2C+Time+%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%84%E0%B8%A3%E0%B8%9A%E0%B8%96%E0%B9%89%E0%B8%A7%E0%B8%99%22)+return+%23+Update+selected_site_config+with+live+GUI+inputs+selected_site_config%5B%22task_details%22%5D+%3D+task_details+%23+Determine+handler+function+and+auto_navigate+site_handler_function+%3D+None+auto_navigate_chosen+%3D+False+if+selected_mode+%3D%3D+%22test%22%3A+if+selected_site_key+%3D%3D+%22popmart_ithitec_test%22%3A+site_handler_function+%3D+test_sites.perform_popmart_ithitec_test+auto_navigate_chosen+%3D+True+elif+selected_site_key+%3D%3D+%22pmrocketbotautoq_test%22%3A+site_handler_function+%3D+test_sites.perform_pmrocketbotautoq_test+auto_navigate_chosen+%3D+True+elif+selected_mode+%3D%3D+%22production%22%3A+if+selected_site_key+%3D%3D+%22popmart_th_production%22%3A+site_handler_function+%3D+production_sites.perform_popmart_th_production+auto_navigate_chosen+%3D+False+%23+Production+mode%3A+user+navigates+manually+if+not+site_handler_function%3A+messagebox.showerror(%22Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B8%9F%E0%B8%B1%E0%B8%87%E0%B8%81%E0%B9%8C%E0%B8%8A%E0%B8%B1%E0%B8%99%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+Site+%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%22)+return+%23+Disable+START+button%2C+enable+STOP+button+self.start_button.config(state%3D%22disabled%22)+self.stop_button.config(state%3D%22normal%22)+%23+---+Launch+Browser+via+.bat+file+---+log_message(%22%5Cn-----------------------------------------------------------%22)+log_message(%22---+%E0%B8%82%E0%B8%B1%E0%B9%89%E0%B8%99%E0%B8%95%E0%B8%AD%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B9%80%E0%B8%95%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%A1%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C+(%E0%B8%97%E0%B8%B3%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%95%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%87)+---%22)+log_message(%22-----------------------------------------------------------%22)+log_message(f%221.+URL+%E0%B9%80%E0%B8%9B%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%A1%E0%B8%B2%E0%B8%A2%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A+Task+%E0%B8%99%E0%B8%B5%E0%B9%89%E0%B8%84%E0%B8%B7%E0%B8%AD%3A+%7Bselected_site_config%5B%27url%27%5D%7D%22)+browser_bat_file+%3D+self.browser_options.get(browser_name)+if+not+browser_bat_file%3A+messagebox.showerror(%22Browser+Error%22%2C+%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%9E%E0%B8%9A%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+.bat+%E0%B8%AA%E0%B8%B3%E0%B8%AB%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B9%80%E0%B8%A5%E0%B8%B7%E0%B8%AD%E0%B8%81%22)+self.stop_automation()+return+user_data_dir_to_pass+%3D+profile_path+if+use_profile+else+%22%22+log_message(f%22%5Cn2.+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C+%27%7Bbrowser_name%7D%27+%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+%27%7Bbrowser_bat_file%7D%27...%22)+log_message(f%22+++(Port%3A+%7Bdebugging_port%7D%2C+Profile%3A+%7B%27Yes%27+if+user_data_dir_to_pass+else+%27No%27%7D)%22)+try%3A+%23+subprocess.Popen+will+run+the+.bat+file+in+a+new+CMD+window+%23+cwd%3D%27.%27+means+the+current+directory+where+main.py+is+located+subprocess.Popen(%5Bbrowser_bat_file%2C+str(debugging_port)%2C+user_data_dir_to_pass%5D%2C+shell%3DTrue%2C+cwd%3D%27.%27)+log_message(f%22+++%E2%9C%85+%E0%B8%AA%E0%B8%B1%E0%B9%88%E0%B8%87%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C+%27%7Bbrowser_name%7D%27+%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%22)+except+Exception+as+e%3A+log_message(f%22%E2%9D%8C+ERROR%3A+%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B8%A3%E0%B8%B1%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+%27%7Bbrowser_bat_file%7D%27+%E0%B9%84%E0%B8%94%E0%B9%89%3A+%7Be%7D%22)+messagebox.showerror(%22Launch+Error%22%2C+f%22%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%AA%E0%B8%B2%E0%B8%A1%E0%B8%B2%E0%B8%A3%E0%B8%96%E0%B8%A3%E0%B8%B1%E0%B8%99%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+%7Bbrowser_bat_file%7D+%E0%B9%84%E0%B8%94%E0%B9%89%22)+self.stop_automation()+return+log_message(%22%5Cn3.+%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B8%94%E0%B8%A3%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B8%82%E0%B8%B6%E0%B9%89%E0%B8%99%E0%B8%A1%E0%B8%B2%E0%B9%80%E0%B8%AD%E0%B8%87%22)+if+auto_navigate_chosen%3A+log_message(f%22+++%E0%B9%82%E0%B8%9B%E0%B8%A3%E0%B9%81%E0%B8%81%E0%B8%A3%E0%B8%A1%E0%B8%88%E0%B8%B0%E0%B8%99%E0%B8%B3%E0%B8%97%E0%B8%B2%E0%B8%87%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4%E0%B9%84%E0%B8%9B%E0%B8%A2%E0%B8%B1%E0%B8%87+%7Bselected_site_config%5B%27url%27%5D%7D+%E0%B9%80%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%84%E0%B8%94%E0%B9%89%22)+else%3A+%23+Production+Mode+log_message(f%22+++%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2+Copy+URL+%E0%B8%94%E0%B9%89%E0%B8%B2%E0%B8%99%E0%B8%9A%E0%B8%99%E0%B9%84%E0%B8%9B%E0%B8%A7%E0%B8%B2%E0%B8%87%E0%B9%83%E0%B8%99%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%97%E0%B8%B5%E0%B9%88%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B9%80%E0%B8%9B%E0%B8%B4%E0%B8%94%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7%3A+%7Bselected_site_config%5B%27url%27%5D%7D%22)+log_message(%22+++%E0%B8%AB%E0%B8%B2%E0%B8%81%E0%B8%A1%E0%B8%B5+CAPTCHA+%E0%B8%AB%E0%B8%A3%E0%B8%B7%E0%B8%AD+%27Unusual+Traffic%27+%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B9%81%E0%B8%81%E0%B9%89%E0%B8%94%E0%B9%89%E0%B8%A7%E0%B8%A2%E0%B8%95%E0%B8%99%E0%B9%80%E0%B8%AD%E0%B8%87%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B9%80%E0%B8%A3%E0%B8%B5%E0%B8%A2%E0%B8%9A%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A2.%22)+log_message(%224.+%E0%B9%80%E0%B8%A1%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%9A%E0%B8%A3%E0%B8%B2%E0%B8%A7%E0%B9%8C%E0%B9%80%E0%B8%8B%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B8%AB%E0%B8%99%E0%B9%89%E0%B8%B2%E0%B9%80%E0%B8%A7%E0%B9%87%E0%B8%9A%E0%B8%9E%E0%B8%A3%E0%B9%89%E0%B8%AD%E0%B8%A1%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+**%E0%B8%81%E0%B8%94%E0%B8%9B%E0%B8%B8%E0%B9%88%E0%B8%A1+%27Start+Task%27+%E0%B9%83%E0%B8%99+GUI+%E0%B8%99%E0%B8%B5%E0%B9%89**+%E0%B9%80%E0%B8%9E%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1%E0%B8%94%E0%B8%B3%E0%B9%80%E0%B8%99%E0%B8%B4%E0%B8%99%E0%B8%81%E0%B8%B2%E0%B8%A3+Task...%22)+%23+Change+START+button+text+and+command+to+%22Start+Task%22+self.start_button.config(text%3D%22Start+Task%22%2C+command%3Dlambda%3A+self.start_task_after_browser_ready(+selected_site_config%2C+site_handler_function%2C+debugging_port%2C+browser_name%2C+auto_navigate_chosen%2C+auto_register_enabled+))+def+start_task_after_browser_ready(self%2C+selected_site_config%2C+site_handler_function%2C+debugging_port%2C+browser_name%2C+auto_navigate_chosen%2C+auto_register_enabled)%3A+%22%22%22Starts+the+automation+task+in+a+new+thread+after+browser+is+ready.%22%22%22+self.start_button.config(state%3D%22disabled%22%2C+text%3D%22Running...%22)+self.stop_button.config(state%3D%22normal%22)+log_message(%22%5Cn---+%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89%E0%B8%81%E0%B8%94+%27Start+Task%27+%E0%B8%81%E0%B8%B3%E0%B8%A5%E0%B8%B1%E0%B8%87%E0%B9%80%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%A1%E0%B8%95%E0%B9%88%E0%B8%AD%E0%B9%81%E0%B8%A5%E0%B8%B0%E0%B9%80%E0%B8%A3%E0%B8%B4%E0%B9%88%E0%B8%A1+Task+---%22)+%23+Start+the+automation+in+a+new+thread+task_thread+%3D+threading.Thread(target%3Drun_task_in_thread%2C+args%3D(+selected_site_config%2C+site_handler_function%2C+debugging_port%2C+browser_name%2C+auto_navigate_chosen%2C+auto_register_enabled+))+self.running_threads.append(task_thread)+task_thread.start()+%23+Reset+START+button+after+a+short+delay+(or+when+thread+completes)+%23+For+simplicity%2C+we%27ll+re-enable+after+a+short+delay%2C+or+you+can+check+thread+status+self.master.after(100%2C+self.check_threads_status)+%23+Check+status+periodically+def+stop_automation(self)%3A+log_message(%22%5Cn---+%E0%B9%84%E0%B8%94%E0%B9%89%E0%B8%A3%E0%B8%B1%E0%B8%9A%E0%B8%84%E0%B8%B3%E0%B8%AA%E0%B8%B1%E0%B9%88%E0%B8%87%E0%B8%AB%E0%B8%A2%E0%B8%B8%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99+---%22)+self.stop_event.set()+%23+Set+stop+signal+%23+Wait+for+threads+to+finish+(optional%2C+can+block+GUI)+%23+For+simplicity%2C+just+disable+buttons+self.start_button.config(state%3D%22normal%22%2C+text%3D%22START%22)+self.stop_button.config(state%3D%22disabled%22)+log_message(%22---+%E0%B8%AA%E0%B8%B4%E0%B9%89%E0%B8%99%E0%B8%AA%E0%B8%B8%E0%B8%94%E0%B8%81%E0%B8%B2%E0%B8%A3%E0%B8%97%E0%B8%B3%E0%B8%87%E0%B8%B2%E0%B8%99%E0%B8%AD%E0%B8%B1%E0%B8%95%E0%B9%82%E0%B8%99%E0%B8%A1%E0%B8%B1%E0%B8%95%E0%B8%B4+---%22)+def+update_log(self)%3A+%22%22%22Periodically+checks+the+log+queue+and+updates+the+Text+widget.%22%22%22+while+not+log_queue.empty()%3A+message+%3D+log_queue.get()+self.log_text.config(state%3D%22normal%22)+self.log_text.insert(END%2C+message+%2B+%22%5Cn%22)+self.log_text.see(END)+%23+Scroll+to+the+end+self.log_text.config(state%3D%22disabled%22)+self.master.after(100%2C+self.update_log)+%23+Check+again+after+100ms+def+check_threads_status(self)%3A+%22%22%22Checks+if+all+threads+have+finished+and+updates+GUI+state.%22%22%22+all_finished+%3D+True+for+thread+in+self.running_threads%3A+if+thread.is_alive()%3A+all_finished+%3D+False+break+if+all_finished%3A+self.start_button.config(state%3D%22normal%22%2C+text%3D%22START%22)+self.stop_button.config(state%3D%22disabled%22)+self.running_threads+%3D+%5B%5D+%23+Clear+the+list+log_message(%22---+%E0%B8%97%E0%B8%B8%E0%B8%81+Task+%E0%B9%80%E0%B8%AA%E0%B8%A3%E0%B9%87%E0%B8%88%E0%B8%AA%E0%B8%B4%E0%B9%89%E0%B8%99%E0%B9%81%E0%B8%A5%E0%B9%89%E0%B8%A7+---%22)+else%3A+self.master.after(500%2C+self.check_threads_status)+%23+Check+again+after+500ms+%23+---+Main+Application+Execution+---+if+__name__+%3D%3D+%22__main__%22%3A+root+%3D+Tk()+load_config()+%23+Load+config+before+creating+GUI+%23+Initial+check+for+windows_username+windows_username+%3D+USER_APP_CONFIG.get(%22windows_username%22)+if+not+windows_username+or+windows_username+%3D%3D+%22YourUsernameHere%22%3A+messagebox.showerror(%22Configuration+Error%22%2C+%22%E0%B8%81%E0%B8%A3%E0%B8%B8%E0%B8%93%E0%B8%B2%E0%B9%81%E0%B8%81%E0%B9%89%E0%B9%84%E0%B8%82%E0%B9%84%E0%B8%9F%E0%B8%A5%E0%B9%8C+user_config.json+%E0%B9%80%E0%B8%9E%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B9%83%E0%B8%AA%E0%B9%88%E0%B8%8A%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%9C%E0%B8%B9%E0%B9%89%E0%B9%83%E0%B8%8A%E0%B9%89+(Username)+%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B8%AD%E0%B8%A1%E0%B8%9E%E0%B8%B4%E0%B8%A7%E0%B9%80%E0%B8%95%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%82%E0%B8%AD%E0%B8%87%E0%B8%84%E0%B8%B8%E0%B8%93%E0%B9%83%E0%B8%AB%E0%B9%89%E0%B8%96%E0%B8%B9%E0%B8%81%E0%B8%95%E0%B9%89%E0%B8%AD%E0%B8%87%22)+root.destroy()+%23+Close+GUI+if+config+is+bad+else%3A+app+%3D+AutoBookingApp(root)+root.mainloop()&gs_lcrp=EgZjaHJvbWUyBggAEEUYOdIBBzczMGowajeoAgCwAgA&sourceid=chrome&ie=UTF-8 